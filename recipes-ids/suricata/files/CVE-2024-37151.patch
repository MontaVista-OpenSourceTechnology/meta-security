From dc0109f7c7b6a97cf2941283d15870facb482a75 Mon Sep 17 00:00:00 2001
From: Vivek Kumbhar <vkumbhar@mvista.com>
Date: Wed, 24 Jul 2024 08:16:13 +0000
Subject: [PATCH] CVE-2024-37151

---
 src/defrag-hash.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/defrag-hash.c b/src/defrag-hash.c
index bec87f9..968512d 100644
--- a/src/defrag-hash.c
+++ b/src/defrag-hash.c
@@ -582,7 +582,7 @@ DefragTracker *DefragGetTrackerFromHash (Packet *p)
                 return dt;
             }

-            if (DefragTrackerCompare(dt, p) != 0) {
+            if (!dt->remove && DefragTrackerCompare(dt, p) != 0) {
                 /* we found our tracker, lets put it on top of the
                  * hash list -- this rewards active trackers */
                 if (dt->hnext) {
--
2.24.4
